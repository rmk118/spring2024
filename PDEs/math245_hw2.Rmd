---
title: "MATH 245 Homework 2"
author: "Ruby Krasnow and Tommy Thach"
date: "2024-02-18"
output:
  pdf_document:
    extra_dependencies: ["derivative", "tcolorbox", "xcolor"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Question 1
Determine the region in which the given equation is hyperbolic, parabolic, elliptic, or singular.  

a) $$u_{xx}-y^2u_{yy}+u_x-u+x^2=0 $$  

$a=1, b=0, c=-y^2$, so we have $b^2-ac=0-(-y^2)=y^2$. This will be positive everywhere except for $y=0$, so the equation is hyperbolic where $y \neq 0$ and parabolic for $y=0$.

b) $$u_{xx}-yu_{yy}+xu_x+yu_y+u=0 $$

$a=1, b=0, c=-y$, so we have $b^2-ac=0-(-y)=y$. Thus, the equation will be hyperbolic where $y>0$, parabolic where $y=0$, and elliptic where $y<0$.

Both PDEs are nowhere singular, because the coefficient of $u_{xx}$ is never zero.

## Question 2
Using a factorization similar to the wave equation, solve the following IVP:
\begin{equation*}
    \begin{cases}
      u_{xx}+2u_{xy}-3u_{yy}=0 & x\subset \mathbb{R},\; y> 0\\
      u(0,x)=\sin{x} & x\subset \mathbb{R}\\
      u_y(0,x) = x & x\subset \mathbb{R}
    \end{cases}       
\end{equation*}

We are looking for a solution $u(x,y)$ for the above IVP. First, we can factor the given PDE as follows:
$$\left( \pdv{}{x}+3\pdv{}{y}\right) \left(\pdv{}{x}-\pdv{}{y}\right)u=0$$
or $$\left( \partial_{x}+3\partial_{y}\right) \left(\partial_{x}-\partial_{y}\right)u=0$$



Then set $\left(\pdv{}{x}-\pdv{}{y}\right)u=v$, giving us

$\left( \pdv{}{x}+3\pdv{}{y}\right)v= v_x+3v_t=0$

which we know has the solution $v(x,y)=f(3x-y)$, so
$$u_x-u_y=f(3x-y)$$
Now we can reorder our equation as $$\left(\partial_{x}-\partial_{y}\right)
\left( \partial_{x}+3\partial_{y}\right)u=0$$
and set $w=\left( \partial_{x}+3\partial_{y}\right)u$

Then $$w_x-w_y=0 $$

Which we know has the solution $w(x,y)=g(x+y)$. So $u_x+3u_y=g(x+y)$, which gives us a system of two equations:

\begin{equation*}
\begin{cases}
u_x-u_y=f(3x-y)
u_x+3u_y=g(x+y)
\end{cases}
\end{equation*}

Subtract the first equation from the second:
$$4u_y=-f(3x-y)+g(x+y) $$

Now we can integrate with respect to $y$ to find that:
$$u(x,y)=F(3x-y)+G(x+y)$$
where $F$ is the antiderivative of $-f$ with respect to $y$ and $G$ is the antiderivative of $g$ with respect to $y$.


Using the fact that $u(0,x)=\sin{x}$, 

 \begin{equation} \label{eq:1} u(0,x)=\sin{x}=F(3x)+G(x) \end{equation}
now replace $x$ with a new neutral variable, $\alpha$ and differentiate:
 $$\sin{\alpha}=F(3\alpha)+G(\alpha) $$
\begin{equation} \label{eq:2} \cos{\alpha}=3F'(3\alpha)+G'(\alpha) \end{equation}

But we can also differentiate $u(x,y)=F(3x-y)+G(x+y)$ with respect to $y$ to get
$$u_y(x,y)=-F'(3x-y)+G'(x+y)$$
but from our initial conditions, we know
$$u_y(0,x)=-F'(3x-0)+G'(x+0)=x$$

Let's replace $x$ by our neutral variable $\alpha$ and solve for $F'$:
$$F'(\alpha)=G'(3\alpha)-\alpha$$
Now plug this into (\ref{eq:2}):
$$\cos{\alpha}=3G'(\alpha)-3\alpha+G'(\alpha)$$

$$G(\alpha)= \frac{1}{4} \int {\cos{\alpha}+3\alpha} = \frac{\sin{\alpha}}{4}+ \frac{3 \alpha^2}{8} $$
So that means (\ref{eq:1}) becomes:
$$\sin{\alpha}=F(3\alpha)+\frac{\sin{\alpha}}{4}+ \frac{3 \alpha^2}{8}$$

$$F(\alpha)=\frac{3\sin{(\frac{\alpha}{3})}}{4}- \frac{\alpha^2}{24}$$


Which means $u(x,y)=F(3x-y)+G(x+y)$ becomes

\begin{tcolorbox}[colback=white, title=Solution]

$$u(x,y)=\frac{3}{4}\sin{\left(x-\frac{y}{3}\right)}- \frac{(3x-y)^2}{24}+  \frac{\sin{(x+y)}}{4}+ \frac{3(x+y)^2}{8}$$
\end{tcolorbox}


\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=Check solution]

 $$u_y=\frac{-1}{4}\cos{\left(x-\frac{y}{3}\right)}+\frac{\cos{(x+y)}}{4}+ x+  \frac{2y}{3} $$
  $$u_{yy}=\frac{-1}{12}\sin{\left(x-\frac{y}{3}\right)}-\frac{\sin{(x+y)}}{4}+ \frac{2}{3} $$
 
$$u_x=\frac{3}{4}\cos{\left(x-\frac{y}{3}\right)}+\frac{\cos{(x+y)}}{4}+y$$
 
$$u_{xx}=\frac{-3}{4} \sin{\left( x-\frac{y}{3} \right)} - \frac{\sin{(x+y)}}{4}$$
  
  
$$u_{xy}=\frac{1}{4}\sin{\left(x-\frac{y}{3}\right)}-\frac{\sin{(x+y)}}{4}+1$$


Check that $u_{xx}+2u_{xy}-3u_{yy}=0$
$$
\left(\frac{-3}{4}+ \frac{2}{4}+\frac{1}{4}\right)\sin{\left(x-\frac{y}{3}\right)}+
\left(\frac{-1}{4}+ \frac{-2}{4}+\frac{3}{4}\right)\sin{(x+y)}+(0+2-3)=0
$$

\end{tcolorbox}

## Question 3 

Solve the Neumann boundary value problem for the wave equation on half line:
\begin{equation*}
    \begin{cases}
      u_{tt}=c^2u_{xx}+f(t,x) & 0<x<\infty\\
      u(0,x)=\phi(x) & 0<x<\infty\\
      u_t(0,x) = \psi(x) & 0<x<\infty\\
      u_x(t,0) = h(t) & t>0
    \end{cases}       
\end{equation*}


The method we will use is to first convert to homogenous Neumann boundary conditions, and then extend the equation to the entire line using the reflection method.

First, define $w(t,x)=u(t,x)-H(t)$, where $H'(t)=h(t)$.

Then our IBVP becomes:
\begin{equation*}
    \begin{cases}
      \square w= \square u - H''(t)=f(t,x)-H''(t) \equiv F(t,x) & x \geq 0, t>0\\
      w(0,x)=u(0,x)-H(0)=\phi(x) - H(0) \equiv \Phi(x) & x \geq 0\\
      w_t(0,x) =  u_t(0,x)  - H'(0)= \psi(x) - H'(0) \equiv \Psi(x) & x \geq 0\\
      w_x(0,x) = u_x(t,0) - H'(0)= u_x(t,0)-h(t) \equiv 0 & t \geq 0
    \end{cases}       
\end{equation*}

Now, since we have homogeneous Neumann boundary conditions, we will use even extensions of the initial data to the whole line, namely:

\begin{equation} 
\Phi_{\text{even}}(x)=
    \begin{cases} 
      \Phi(x) & \text{for } x \geq 0\\
      \Phi(-x) & \text{for } x \leq 0\\
    \end{cases}  
    ,\quad
\Psi_{\text{even}}(x)=
    \begin{cases}
      \Psi(x) & \text{for } x \geq 0\\
      \Psi(-x) & \text{for } x \leq 0\\
    \end{cases}
    ,\quad
F_{\text{even}}(t,x)=
    \begin{cases} 
      F(t,x) & \text{for } x \geq 0\\
      F(t,-x) & \text{for } x \leq 0\\
      \end{cases}
\end{equation}

Then we assume $U(t,x)$ is an extension of $w(t,x)$ to the whole line. Since the initial condition and non-homogeneous parts are both even, the solution $U$ is even, so we automatically have $U_x(t,0)=0$.

Consider
\begin{equation} 
    \begin{cases} 
      \square U(t,x)=F_{\text{even}}(t,x) & \text{for } x \in \mathbb{R}, t>0\\
      U(0,x)=\Phi_{\text{even}}(x) & \text{for } x \in \mathbb{R} \\
      U_t(0,x)=\Psi_{\text{even}}(x) & \text{for } x \in \mathbb{R}
    \end{cases} 
\end{equation}

The solution at point $(t_0, x_0)$ is

\begin{equation*}
U(t_0,x_0)= \frac{\Phi_{\text{even}}(x_0+ct_0)+\Phi_{\text{even}}(x_0-ct_0)}{2} +
\frac{1}{2c} \int_{x_0-ct_0}^{x_0+ct_0}\Psi_{\text{even}}(x)dx + \\
\frac{1}{2c} \int_{0}^{t_0}  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} F_{\text{even}}(t,x) dx\,dt
\end{equation*}

Assume $t_0>0, x_0>0 \Rightarrow x_0+ct_0 >0$. Now assume $x_0>ct_0$, so the domain of dependence is entirely to the right of the line $x=ct$. This means $w(t_0, x_0)=U(t_0,x_0)$ and our solution is
\begin{equation*}
w(t_0,x_0)= \frac{\Phi(x_0+ct_0)+\Phi(x_0-ct_0)}{2} +
\frac{1}{2c} \int_{x_0-ct_0}^{x_0+ct_0}\Psi(x)dx + \\
\frac{1}{2c} \int_{0}^{t_0}  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} F(t,x) dx\,dt 
\end{equation*}

\begin{equation*}
=\frac{\phi(x_0+ct_0)-H(0)+\phi(x_0-ct_0)-H(0)}{2} +
\frac{1}{2c} \int_{x_0-ct_0}^{x_0+ct_0}\psi(x)-H'(0)dx + \\
\frac{1}{2c} \int_{0}^{t_0}  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x)-H''(t) dx\,dt
\end{equation*}

\begin{align*}
& w(t_0,x_0)=\frac{\phi(x_0+ct_0)+\phi(x_0-ct_0)}{2}- H(0) +
\frac{1}{2c} \int_{x_0-ct_0}^{x_0+ct_0}\psi(x) dx - \frac{H'(0)}{2c}\left[(x_0+ct_0)-(x_0-ct_0)\right]+ \\
& \frac{1}{2c} \int_{0}^{t_0}  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) dx\,dt -
\frac{1}{2c} \int_{0}^{t_0} H''(t)  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} dx\,dt
\end{align*}


We can rewrite this as
\begin{align*}
& w(t_0,x_0)= \color{blue} \frac{\phi(x_0+ct_0)+\phi(x_0-ct_0)}{2} +
\frac{1}{2c} \int_{x_0-ct_0}^{x_0+ct_0}\psi(x) dx +
\frac{1}{2c} \int_{0}^{t_0}  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) dx\,dt \\
\color{black}
& -H(0)-H'(0)t_0- \frac{1}{2c}\int_{0}^{t_0} H''(t) 2c(t_0-t)dt.
\end{align*}

Call the section in blue "A".

This means we have 
\begin{equation}\label{eqn:w1} 
w(t_0,x_0)=A-H(0)-H'(0)t_0- \int_{0}^{t_0} H''(t)(t_0-t)\,dt 
\end{equation}

Now we use integration by parts on the final integral in (\ref{eqn:w1}), setting
$$u=(t_0-t), \quad du=-dt, \quad dv=H''(t)dt, \quad v=H'(t)$$,

so that 
$$\int_{0}^{t_0} H''(t)(t_0-t)\,dt =H'(t)(t_0-t)\vert_{0}^{t_0}+\int_{0}^{t_0} H'(t)dt=-H'(0)t_0+H(t_0)-H(0) $$
So (\ref{eqn:w1}) becomes

$$w(t_0,x_0)=A-H(0)-H'(0)t_0+H'(0)t_0-H(t_0)+H(0)$$
$$w(t_0,x_0)=A-H(t_0)$$

Since $u(t,x)=u(t,x)+H(t)$, we get $u(t_0, x_0)=A$, or
\begin{equation} \label{eqn:part1}
u(t_0, x_0)=\frac{\phi(x_0+ct_0)+\phi(x_0-ct_0)}{2} +
\frac{1}{2c} \int_{x_0-ct_0}^{x_0+ct_0}\psi(x) dx +
\frac{1}{2c} \int_{0}^{t_0}  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) dx\,dt
\end{equation}

when $x_0>ct_0$.

Now we must consider what happens when $x_0<ct_0$, such that $x_0-ct_0<0$. Then we have
\begin{align*}
&w(t_0,x_0)= \frac{\phi(x_0+ct_0)-H(0)+\phi(ct_0-x_0)-H(0)}{2} \;+ \\
& \frac{1}{2c} \int_{x_0-ct_0}^{0} \psi(-x)-H'(0)\,dx\; + 
\frac{1}{2c} \int_{0}^{x_0+ct_0} \psi(x) -H'(0)\,dx \;+ \\
&\frac{1}{2c} \iint\limits_\Delta F_{\text{even}}(t,x) \, dx \, dt
\end{align*}

\begin{align*}
&w(t_0,x_0)= \frac{\phi(x_0+ct_0)+\phi(ct_0-x_0)}{2}-H(0) +\\
 & \color{violet} \frac{1}{2c} \int_{x_0-ct_0}^{0}\psi(-x)-H'(0)\,dx \;+ 
\frac{1}{2c} \int_{0}^{x_0+ct_0}\psi(x) -H'(0)\,dx \; \color{black} + \\
&\frac{1}{2c}\iint\limits_\Delta F_{\text{even}}(t,x)\,dx\,dt
\end{align*}

Where $\Delta$ is the 2D  region in the diagram below.  

Violet section:
\begin{align*}
& \frac{1}{2c} \int_{x_0-ct_0}^{0}\psi(-x)\,dx \; + 
\frac{1}{2c} \int_{0}^{x_0+ct_0}\psi(x)\,dx \; 
-\frac{1}{2c} \left[ H'(0)(0-(x-ct_0))+H'(0)(x+ct_0-0) \right] = \\
& \frac{1}{2c} \left[\int_{0}^{ct_0-x_0}\psi(x)\,dx +  \int_{0}^{x_0+ct_0}\psi(x)\,dx \right]-H'(0)t_0
\end{align*}

Now we investigate $\frac{1}{2c}\iint\limits_\Delta F_{\text{even}}(t,x)\,dx\,dt$.

```{r, warning=FALSE, fig.height=3, fig.width=5, echo=FALSE}
c=1
t_0=5
x_0=3
x_1=seq(-20, 20, by=0.2)
x_2=seq(-20, 3, by=0.2)
x_3=seq(3, 20, by=0.2)
rm(x)

ggplot()+
  geom_line(aes(x=x_2, y=t_0-(1/c)*(x_0-x_2)))+
  geom_line(aes(x=x_3, y=t_0+(1/c)*(x_0-x_3)))+
  lims(y=c(0, 10), x=c(-5, 10))+
  geom_vline(xintercept=0, linetype="dashed")+
  geom_hline(yintercept = t_0-x_0/c, linetype="dashed")+
  geom_text(aes(x=-0.5, y=0.6, label="I"))+
  geom_text(aes(x=3, y=0.6, label="II"))+
  geom_text(aes(x=3, y=t_0-x_0/c+1, label="III"))+
  annotate("text", label="'('* x[0]* ','* t[0] *')'", x=3, y=5.5, size=3, parse = TRUE)+
  labs(x="x", y="t")+
  theme_light()
```

<!-- \newcommand{\Int}{\int\limits} -->

$$ \text{I}= \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{x_0-c(t_0-t)}^{0} F(t,-x)\;dx\;dt , \quad
\text{II}= \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} F(t,x)\;dx\;dt,$$
$$\text{III}= \frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} F(t,x) \;dx\;dt $$

Now we will evaluate each integral separately:

$$ \text{I}= \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{x_0-c(t_0-t)}^{0} f(t,-x)-H''(t)\;dx\;dt$$
$$ = \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{x_0-c(t_0-t)}^{0} f(t,-x)\;dx\;dt -\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}}H''(t) \int_{x_0-c(t_0-t)}^{0}dx\;dt$$
$$ = -\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{-x_0+c(t_0-t)}^{0} f(t,x)\;dx\;dt +\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}}H''(t) (x_0-c(t_0-t))\;dt$$
$$ = \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{c(t_0-t)-x_0} f(t,x)\;dx\;dt +\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}}H''(t) (x_0-c(t_0-t))\;dt$$



$$\text{II}= \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt-
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t)\int_{0}^{x_0+c(t_0-t)}dx\;dt$$ 

$$= \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt-
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t)(x_0+c(t_0-t))\;dt$$



$$\text{III}= \frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt -\frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} H''(t) \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} dx\;dt $$
$$ = \frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt -\frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} H''(t) \;2c(t_0-t)\;dt $$
$$ = \frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt -\int_{t_0-\frac{x_0}{c}}^{t_0} H''(t) \;(t_0-t)\;dt $$
Now we use integration by parts on the final integral in the above expression, setting
$$u=(t_0-t), \quad du=-dt, \quad dv=H''(t)dt, \quad v=H'(t)$$

so that 
$$\int_{t_0-\frac{x_0}{c}}^{t_0}  H''(t)(t_0-t)\,dt =H'(t)(t_0-t)\vert_{t_0-\frac{x_0}{c}}^{t_0}+\int_{t_0-\frac{x_0}{c}}^{t_0}  H'(t)dt$$
$$=-\frac{x_0}{c} H'\left(t_0-\frac{x_0}{c} \right)+H(t_0)-H\left(t_0-\frac{x_0}{c} \right)$$

So $\text{III}$ is
$$\frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt+\frac{x_0}{c} H'\left(t_0-\frac{x_0}{c} \right)-H(t_0)+H\left(t_0-\frac{x_0}{c} \right) $$


And now we can find the sum of the three regions:

\begin{align*}
\text{I}+\text{II}+\text{III}&= \frac{1}{2c} \int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{c(t_0-t)-x_0} f(t,x)\;dx\;dt +\frac{1}{2c} \int_{0}^{t_0-\frac{x_0}{c}} H''(t) (x_0-c(t_0-t))\;dt + \\
& \frac{1}{2c} \int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt-
\frac{1}{2c} \int_{0}^{t_0-\frac{x_0}{c}} H''(t)(x_0+c(t_0-t))\;dt + \\
& \frac{1}{2c} \int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt+ \\
& \frac{x_0}{c} H'\left(t_0-\frac{x_0}{c} \right) - H(t_0)+H\left(t_0-\frac{x_0}{c} \right)
\end{align*}

\begin{align*}
& =\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{c(t_0-t)-x_0} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt+ \\
& \color{blue} \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}}H''(t) (x_0-c(t_0-t))\;dt
-\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}}H''(t) (x_0+c(t_0-t))\;dt\,+\\
& \frac{x_0}{c} H'\left(t_0-\frac{x_0}{c} \right)-H(t_0)+H\left(t_0-\frac{x_0}{c} \right)
\end{align*}


\begin{align*}
\color{blue}
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t) (x_0-c(t_0-t))\;dt
-\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t) (x_0+c(t_0-t))\;dt = \\
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t) (-c(t_0-t))\;dt
-\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t)c(t_0-t)\;dt = \\
-\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t) c(t_0-t)\;dt
-\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} H''(t)c(t_0-t)\;dt = \\
-\int_{0}^{t_0-\frac{x_0}{c}} H''(t) (t_0-t)\;dt
\end{align*}


Now we use integration by parts, so that 
$$\int_{0}^{t_0-\frac{x_0}{c}}  H''(t)(t_0-t)\,dt =H'(t)(t_0-t)\vert_{0}^{t_0-\frac{x_0}{c}}+\int_{0}^{t_0-\frac{x_0}{c}}  H'(t)dt = \\
\frac{x_0}{c}H'\left(t_0-\frac{x_0}{c}\right)+H\left(t_0-\frac{x_0}{c}\right)-H(0)$$

\begin{align*}
\text{I}& +\text{II}+\text{III} = \\
& \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{c(t_0-t)-x_0} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt \\
& \color{blue}-\frac{x_0}{c}H'\left(t_0-\frac{x_0}{c}\right)-H\left(t_0-\frac{x_0}{c}\right)+H(0)+\\
\color{black}
& \frac{x_0}{c} H'\left(t_0-\frac{x_0}{c} \right)-H(t_0)+H\left(t_0-\frac{x_0}{c} \right)
\end{align*}

\begin{align*}
\text{I}& +\text{II}+\text{III} = \\
& \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{c(t_0-t)-x_0} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt + \\
& H(0) -H(t_0)
\end{align*}

\begin{align*}
& w(t_0,x_0)= \frac{\phi(x_0+ct_0) +\phi(ct_0-x_0)}{2}-H(0) + \\
& \frac{1}{2c} \left[\int_{0}^{ct_0-x_0}\psi(x)\,dx +  \int_{0}^{x_0+ct_0}\psi(x)\,dx \right]-H'(0)t_0 + \\
& \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{c(t_0-t)-x_0} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt + \\
& H(0) -H(t_0)
\end{align*}


```{r, warning=FALSE, fig.height=3, fig.width=5, echo=FALSE}
c=1
t_0=5
x_0=3
x_1=seq(-20, 20, by=0.2)
x_2=seq(-20, x_0, by=0.2)
x_3=seq(x_0, 20, by=0.2)
x_4=seq(0, t_0-c*x_0, by=0.2)
rm(x)

ggplot()+
  geom_line(aes(x=x_2, y=t_0-(1/c)*(x_0-x_2)))+
  geom_line(aes(x=x_3, y=t_0+(1/c)*(x_0-x_3)))+
  geom_polygon(aes(x=c(0, 0, x_0, x_0+c*t_0), y=c(0,t_0-x_0/c, t_0,0)), fill="blue", alpha=0.3)+
  geom_polygon(aes(x=c(0, 0, t_0-c*x_0), y=c(0,t_0-x_0/c, 0 )), fill="red", alpha=0.5)+
  
  lims(y=c(0, 10), x=c(-5, 10))+
  geom_vline(xintercept=0, linetype="dashed")+
  geom_hline(yintercept = t_0-x_0/c, linetype="dashed")+
  geom_text(aes(x=-0.5, y=0.6, label="I"))+
  geom_text(aes(x=3, y=0.6, label="II"))+
  geom_text(aes(x=3, y=t_0-x_0/c+1, label="III"))+
  annotate("text", label="'('* x[0]* ','* t[0] *')'", x=3, y=5.5, size=3, parse = TRUE)+
  labs(x="x", y="t")+
  theme_light()

```

When $x_0<ct_0$, we're integrating $f$ over the domain of dependence (the shaded blue region, including the red triangle) but then adding $f$ integrated over the red triangle. When $x_0<ct_0$, we just integrate $f$ over the blue triangle. 

```{r, warning=FALSE, echo=FALSE, fig.height=3, fig.width=5}
x_0=6
x_1=seq(-20, 20, by=0.2)
x_2=seq(-20, x_0, by=0.2)
x_3=seq(x_0, 20, by=0.2)

ggplot()+
  geom_line(aes(x=x_2, y=t_0-(1/c)*(x_0-x_2)))+
  geom_line(aes(x=x_3, y=t_0+(1/c)*(x_0-x_3)))+
  geom_polygon(aes(x=c(x_0-c*t_0,  x_0+c*t_0, x_0) , y=c(0,0, t_0)), fill="blue", alpha=0.3)+
 lims(y=c(0, 10), x=c(-5, 15))+
  geom_vline(xintercept=0, linetype="dashed")+
  geom_hline(yintercept = t_0-x_0/c, linetype="dashed")+
  annotate("text", label="'('* x[0]* ','* t[0] *')'", x=x_0, y=5.5, size=3, parse = TRUE)+
  labs(x="x", y="t")+
  theme_light()
```

\begin{tcolorbox}[colback=white, title=Solution]

So for $ct_0>x_0$, $u(t_0,x_0) =w(t_0,x_0)+H(t_0)$, which means
\begin{align*}
&u(t_0,x_0)= \frac{\phi(x_0+ct_0) +\phi(ct_0-x_0)}{2}+ \\
& \frac{1}{2c} \left[\int_{0}^{ct_0-x_0}\psi(x)\,dx +  \int_{0}^{x_0+ct_0}\psi(x)\,dx \right]-H'(0)t_0 + \\
& \frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{c(t_0-t)-x_0} f(t,x)\;dx\;dt + 
\frac{1}{2c}\int_{0}^{t_0-\frac{x_0}{c}} \int_{0}^{x_0+c(t_0-t)} f(t,x)\;dx\;dt + \\
& \frac{1}{2c}\int_{t_0-\frac{x_0}{c}}^{t_0} \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) \;dx\;dt \\
\end{align*}

While for $ct_0>x_0$, from (\ref{eqn:part1}), we have
$$u(t_0, x_0)=\frac{\phi(x_0+ct_0)+\phi(x_0-ct_0)}{2} +
\frac{1}{2c} \int_{x_0-ct_0}^{x_0+ct_0}\psi(x) dx +
\frac{1}{2c} \int_{0}^{t_0}  \int_{x_0-c(t_0-t)}^{x_0+c(t_0-t)} f(t,x) dx\,dt$$

\end{tcolorbox}



## Question 4  

Consider the 3D wave equation for $u(t,x,y,z)$:

$$u_{tt}=c^2\Delta u \quad\quad (x,y,z) \in \mathbb{R}^3, \quad t>0$$

Change the coordinates to spherical coordinates. Assume the solution is spherically symmetric, so that $u(t,x,y,z)=u(t,r)$ and does not depend on $\theta$ and $\phi$. Find the solution for $u(0,r)=0$ and

\begin{equation*} u_t(0,r) = \begin{cases}
  1  & \lvert{r}\rvert \leq 1 \\
  0 &  \lvert{r}\rvert > 1
\end{cases}
\end{equation*}

Hint: use the substitution $u(t,r)= \frac{1}{r} w(t,r)$.


First, we need to derive the formula for the Laplacian in spherical coordinates.


We know the equation for the Laplacian in polar coordinates is:

$$\frac{\partial^2}{\partial r^2}+\frac{1}{r}\frac{\partial}{\partial r}+ \frac{1}{r^2}\frac{\partial^2}{\partial \theta^2}$$

Now let's convert to spherical coordinates:

$$r=\sqrt{x^2+y^2+z^2}=\sqrt{s^2+z^2}$$

$$x=s \cos{\phi}, \quad y=s \sin{\phi}, \quad z=r \cos{\theta}$$
$$s=r \sin{\theta}$$

By the two-dimensional Laplacian, we have

$$u_{zz}+u_{ss}=u_{rr}+\frac{1}{r}u_r+\frac{1}{r^2}u_{\theta\theta},$$

$$u_{xx}+u_{yy}=u_{ss}+\frac{1}{s}u_s+\frac{1}{s^2}u_{\phi\phi}$$
We add these two equations and cancel $u_s$ to get

$$\Delta u = u_{rr}+\frac{1}{r}u_r+\frac{1}{r^2}u_{\theta\theta}+\frac{1}{s}u_s+\frac{1}{s^2}u_{\phi\phi}$$

Now since $u$ doesn't depend on $\theta$ or $\phi$, we have
$$\Delta u = u_{rr}+\frac{1}{r}u_r+\frac{1}{s}u_s=u_{rr}+\frac{1}{r}u_r+\frac{1}{r \sin{\theta}}u_s$$

$$ \frac{\partial u}{\partial s} = \frac{\partial u}{\partial r} \frac{\partial r}{\partial s}+\frac{\partial u}{\partial\theta}\frac{\partial\theta}{\partial s}+\frac{\partial u}
{\partial\phi}\frac{\partial\phi}{\partial s}=u_r\frac{1}{ \sin{\theta}}+0+0=u_r\frac{s}{ r}$$

So with our change of variables, we have

$$u_{tt}=c^2 \left(u_{rr} + \frac{2}{r}u_r \right)$$

Now set $w=ru$, or $u= \frac{w}{r}$. Then 
$$w_t=ru_t, \quad w_{tt}=ru_{tt}, \quad u_{tt}= \frac{w_{tt}}{r} $$
$$w_t=ru_t, \quad w_{tt}=ru_{tt}, \quad u_{tt}= \frac{w_{tt}}{r} $$
$$u_r = \frac{w_r}{r}-\frac{w}{r^2} $$

$$u_{rr} = \frac{w_{rr}}{r}-\frac{2w_r}{r^2}+\frac{2w}{r^3} $$
So $u_{tt}=c^2 \left(u_{rr} + \frac{2}{r}u_r \right)$ becomes

$$\frac{w_{tt}}{r} =c^2 \left(\frac{w_{rr}}{r}-\frac{2w_r}{r^2}+\frac{2w}{r^3} + \frac{2}{r} \left(\frac{w_r}{r}-\frac{w}{r^2} \right) \right),$$
which simplifies to
$$w_{tt}=c^2 w_{rr}.$$
But this is just the wave equation, giving us the following IVP:

\begin{equation*} 
\begin{cases}
w_{tt}=c^2 w_{rr} & t>0, \, r \geq 0\\
u(0,r)=0 & r \geq 0\\
u_t(0,r) = \begin{cases}
  1  & \lvert{r}\rvert \leq 1 \\
  0 &  \lvert{r}\rvert > 1
  \end{cases} & r \geq 0\\
\end{cases}
\end{equation*}


Although $r$ is nonnegative, since $\varphi=0$ and there are absolute value bars in $\phi$, we can safely use d'Alembert's formula to find the solution:
 $$w(t,r)= \frac{\varphi(r+ct)+\varphi(r-ct)}{2}+\frac{1}{2c} \int_{r-ct}^{r+ct}{\psi(s)ds}$$
 Since $\varphi=0$, 
 $$w(t,r)= \frac{1}{2c} \int_{r-ct}^{r+ct}{\psi(s)ds}$$

Now we have 4 cases:

Case 1: $r-ct \geq -1, r+ct \leq 1$
$$w(t,r)= \frac{1}{2c} \int_{r-ct}^{r+ct}{s\;ds}$$

$$= \frac{1}{4c} ((r+ct)^2-(r-ct)^2)$$
$$= \frac{1}{4c}(r^2+2crt+c^2t^2-r^2+2crt-c^2t^2)= \frac{4crt}{4c}=rt  $$


Case 2:$r-ct < -1, r+ct>1$
$$w(t,r)= \frac{1}{2c} \int_{-1}^{1}{s\;ds}=$$
$$w(t,r)= \frac{1}{4c} (1-1)=0$$


Case 3:$r-ct < -1, r+ct \leq 1$
$$w(t,r)= \frac{1}{2c} \int_{-1}^{r+ct}{s\;ds}$$

$$= \frac{1}{4c} ((r+ct)^2-1)$$

Case 4:$r-ct \geq -1, r+ct>1$
$$w(t,r)= \frac{1}{2c} \int_{r-ct}^{1}{s\;ds}$$
$$= \frac{1}{4c} (1-(r-ct)^2)$$

Since $u=\frac{w}{r}$, this means we have
\begin{tcolorbox}[colback=white, title=Solution]
\begin{equation*}u(t,r)=
    \begin{cases} 
      t & \text{ if } r-ct \geq -1, r+ct \leq 1\\
      0 & \text{ if } r-ct < -1, r+ct > 1\\
      \frac{1}{4rc} ((r+ct)^2-1) & \text{ if } r-ct < -1, r+ct \leq 1\\
      \frac{1}{4rc} (1-(r-ct)^2) &\text{ if }  r-ct \geq -1, r+ct > 1\\
    \end{cases}       
\end{equation*}
\end{tcolorbox}

## Question 5
Consider the following Dirichlet boundary value problem:
\begin{equation*} 
\begin{cases}
  u_{tt}+x(t,x)u_t=u_{xx} & 0<x<1 \\
  u(0,x)=\phi(x) & 0<x<1 \\
  u_t(0,x)=\psi(x) & 0<x<1 \\
  u(t,0) = u(t,1)=0 & t \geq 0 \\
\end{cases}
\end{equation*}

Assume that $\lvert a(t,x)\rvert \leq m$ for some constant $m$ and all $0<x<1$ and $t\geq 0$. Let 
$$E(t)= \frac{1}{2} \int_{0}^{1}{ \left(u_t(t,x)^2+u_x(t,x)^2\right)}\:dx $$

(1) Show that 
\begin{equation}\label{eqn:E} 
\frac{dE(t)}{dt} \leq 2mE(t)
\end{equation}
for $t \geq 0$.


First differentiate $E(t)$:

$$ \frac{dE}{dt}= \frac{d}{dt} \left[\frac{1}{2} \int_{0}^{1}{ \left(u_t^2+u_x^2\right)}\:dx \right]$$ 
\begin{equation} \label{eqn:prob5a}
=\frac{1}{2} \int_{0}^{1}{ \frac{\partial}{\partial t} \left(u_t^2+u_x^2\right)} \:dx
\end{equation}

\begin{equation} \label{eqn:prob5b}
=\frac{1}{2} \int_{0}^{1}{ 2u_t u_{tt}+ 2u_x u_{xt}}\:dx
\end{equation}

\begin{equation}\label{eqn:prob5c}
=\int_{0}^{1}{ u_t u_{tt}}\: dx + \int_{0}^{1}{u_x u_{xt}}\:dx =: I+J.
\end{equation}

The equality (\ref{eqn:prob5a}) follows from differentiation under the integral sign, while (\ref{eqn:prob5b}) follows from the chain rule for partial derivatives.  

Consider the integral $J$ in (\ref{eqn:prob5c}). By integrating by parts, we can move one of the partials $\frac{\partial}{\partial x}$ to the other factor, at the cost of introducing a minus sign and a boundary term. Hence $J$ becomes

\begin{equation} \label{eqn:J}
J=\int_{0}^{1}{ u_x u_{xt}}\: dx =- \int_{0}^{1}{u_{xx} u_t}\:dx + 
\left[ u_x u_t \right]_{x=0}^{x=1}.
\end{equation}

The boundary term vanishes, since $u(t,0) \equiv u(t,1)  \equiv 0$ for $t>0$ implies that $u_t$ is identically zero at $x=0,1$. So, substituting (\ref{eqn:J}) for $J$, equation (\ref{eqn:prob5c}) becomes
 $$ I+J=\int_{0}^{1}{u_t u_{tt}} \;dx - \int_{0}^{1}{u_{xx} u_t} \;dx$$
 $$= \int_{0}^{1} {u_t (u_{tt}-u_{xx})} \;dx$$
\begin{equation} \label{eqn:J2}
=\int_{0}^{1}{ u_t(-au_t) }\:dx
\end{equation}

\begin{equation} \label{eqn:J3}
=\int_{0}^{1}{ (-a)u_t^2 }\: dx.
\end{equation}

Here, equality (\ref{eqn:J2}) just uses the PDE. Since $u_t^2 \geq 0$ and $-a \leq \lvert -a \rvert \leq m$, we see that $(-a)u_t^2 \leq mu_t^2$. Hence, the expression in (\ref{eqn:J3}) satisfies the inequality

\begin{equation} \label{eqn:IJ}
I+J= \int_{0}^{1}{ (-a)u_t^2 }\:dx \leq \int_{0}^{1}{ mu_t^2 }\:dx \leq m \int_{0}^{1}{ u_t^2 + u_x^2 }\:dx =2mE.
\end{equation}

Where we also used the fact that $u_x^2 \geq 0$ means that $m\int_{0}^{1}{ u_t^2 }\:dx \leq m\int_{0}^{1}{ (u_t^2 + u_x^2) }\:dx$.  

The desired inequality (\ref{eqn:E}) follows from (\ref{eqn:IJ}) and the fact that $\frac{dE}{dt}=I+J.$

(2) Use part (1) and show that $\frac{d}{dt} \left( e^{-2mE(t)} \right) \leq 0$ for 
all $t \geq 0$. Hence, by integration from $[0,t]$, we get that 

\begin{equation}\label{eqn:leq}
E(t) \leq e^{2mt} E(0) \text{ for all } t \geq 0.
\end{equation}


By the product rule, 
$$ \frac{d}{dt} \left(e^{-2mt}E\right)=-2me^{-2mt}E+e^{-2mt}\frac{dE}{dt} $$
$$=e^{-2mt}\left(\frac{dE}{dt}-2mE\right) $$
$$\leq e^{-2mt} \cdot 0=0. $$



(3) If $\phi(x)=\psi(x)=0$ for all $0<x<1$, what does this say about $E(t)$ for $t \geq 0$ and hence about $u(t,x)$ for $t \geq 0$?

Since $u(0,x) \equiv \varphi(x) \equiv 0$ for $0<x<1$, we see that $u_x$ is identically zero at time $t=0$. Similarly, $u_t(0,x) \equiv \psi(x) \equiv 0$ for $0<x<1$. Thus at $t=0$,

\begin{equation}\label{eqn:E0}
E(0)= \frac{1}{2} \int_{0}^{1}{ \left(u_t(t,0)^2+u_x(t,0)^2\right)}\:dx =\frac{1}{2} \int_{0}^{1}{0^2+0^2 \:dx=0.}
\end{equation}

But (\ref{eqn:E0}) together with the inequality (\ref{eqn:leq}) implies that 

$$0 \leq E(t)  \leq e^{2mt}E(0) \leq 0$$
for all $t \geq 0$. Hence the energy $E$ is identically zero. Since the integrand $u_t^2+u_x^2$ is nonnegative, this is only possible if $u_t \equiv u_x \equiv 0$ for $t>0, 0<x<1$, meaning that $u$ varies with neither time nor position. But this implies that $u$ must be identically zero everywhere.

(4) Use the previous part to prove uniqueness of the following problem:
\begin{equation*} 
\begin{cases}
  u_{tt}+a(t,x)u_t=u_{xx} & 0<x<1, t>0 \\
  u(0,x)=\phi(x) & 0<x<1 \\
  u_t(0,x)=\psi(x) & 0<x<1 \\
  u(t,0) = f(t) & t \geq 0 \\
  u(t,1) = g(t) & t \geq 0 \\
\end{cases}
\end{equation*}



Let $u$ and $v$ be two solutions, and define $w:=u-v$. Observe that $w$ satisfies the original boundary value problem along with the conditions specified in part (3), implying that $w \equiv 0$.  Hence $u-v\equiv 0$ and so any solution $u$ must be unique. $\square$

## Problem 6

Does the D’Alembert method work for the wave equation $u_{tt} = c(x)^2u_{xx}$? What about $u_{tt} = c(t)^2u_{xx}$? Why?


Let's assume that we can factor this wave equation with $c=c(x)$ as we could with constant $c$:
$$\left( \partial_{t}+c(x)\partial_{x}\right) \left(\partial_{t}-c(x)\partial_{x}\right)u=0$$
Now, let's distribute:
$$\left( \partial_{t}+c(x)\partial_{x}\right) \left(u_{t}-c(x)u_{x}\right)=0$$
$$u_{tt}-c(x)u_{xt} +c(x)u_{xt}-c(x)\left(c'(x)u_x+c(x)u_{xx}\right) =0$$
$$u_{tt}-c(x)^2u_{xx}- c(x)c'(x)u_x=0$$
But this is only equivalent to our original equation if $c'(x)=0$ for all $x$, i.e., if $c$ is constant.

We can repeat the process for $c=c(t)$:
$$\left( \partial_{t}+c(t)\partial_{x}\right) \left(\partial_{t}-c(t)\partial_{x}\right)u=0$$
$$\left( \partial_{t}+c(t)\partial_{x}\right) \left(u_{t}-c(t)u_{x}\right)=0$$
$$u_{tt}-(c'(t)u_{x}+c(t)u_{xt}) +c(t)u_{xt}-c(t)^2u_{xx} =0$$
$$u_{tt}-c(t)^2u_{xx}- c'(t)u_x=0$$

Which, as before, is only equivalent to our original equation if $c'(t)=0$ for all $t$, i.e., if $c$ is constant.

## Problem 7 (The Poisson-Darboux Equation)   
Solve the initial value problem

\begin{equation*} 
\begin{cases}
  u_{tt}-u_{xx}- \frac{2}{x}u_x=0 & -\infty <x<\infty, t>0 \\
  u(0,x)=0 & -\infty <x<\infty \\
  u_t(0,x)=g(x) & -\infty <x< \infty \\
\end{cases}
\end{equation*}

where $g(x)=g(-x)$ is an even function. Hint: set $w=xu$.


Using the results from when we set $w=ru$ in Problem 4,
$$u_t=\frac{w_t}{x}, u_{tt}=\frac{w_{tt}}{x} $$
$$u_x= \frac{w_x}{x}- \frac{w}{x^2} $$

$$u_{xx}=  \frac{w_{xx}}{x}-\frac{2w_x}{x^2}+\frac{2w}{x^3}$$
So $u_{tt}-u_{xx}- \frac{2}{x}u_x=0$ becomes

$$\frac{w_{tt}}{x} -\frac{w_{xx}}{x}+\frac{2w_x}{x^2}- \frac{2w}{x^3}- \frac{2}{x} \left(\frac{w_x}{x}- \frac{w}{x^2}\right)=0 $$
Which simplifies to $w_{tt}-w_{xx}=0$, and so $w$ solves the wave equation when $-\infty <x<\infty, t>0$. 

Now observe that $w(0,x)=xu(0,x)=0$ and $w_t(0,x)=xu_t(0,x)=xg(x)$. Hence, $w$ solves the initial value problem:

\begin{equation} \label{eqn:prob7}
    \begin{cases}
      w_{tt}-w_{xx} & -\infty <x<\infty, t>0 \\
      w(0,x)=0 & -\infty <x<\infty, t>0 \\
      w_t(0,x) = xg(x) & -\infty <x<\infty, t>0
    \end{cases}       
\end{equation}

whre $g(x)$ is an even function.

By d'Alembert's formula, the solution to (\ref{eqn:prob7}) is given by:
$$w(t,x)=\frac{1}{2} \int_{x-t}^{x+t}{sg(s)ds}$$
Hence since $w_t=xu_t$, 
\begin{equation} \label{eqn:prob7a}
w(t,x)=\frac{1}{2x} \int_{x-t}^{x+t}{sg(s)ds,}
\end{equation}
assuming $x \neq 0$.

To handle the case when $x=0$, assume that $u$ is continuous in $x$, so that $u(t,0)=\lim_{x\to 0} u(t,x)$. Define

$$I(y)=\int_{0}^{y}sg(s)\;ds. $$

This allows us to rewrite (\ref{eqn:prob7a}) as

$$u(t,x)=\frac{I(x+t)-I(x-t)}{2x}= \frac{I(x+t)-I(t-x)}{2x},$$
Noting that the evenness of $g(s)$ means that $sg(s)$ is odd, and so $I(y)$ is even (one can check by substitution that $I(y)=I(-y)$). Hence, letting $x \rightarrow 0$, we see that 

\begin{equation}\label{eqn:prob7b}
u(t,0)= \lim_{x\to 0} \frac{I(t+x)-I(t-x)}{2x}.
\end{equation}

But this is just the form of a derivative, namely the symmetric derivative of $I$ at $t$. By the Fundamental Theorem of Calculus, assuming $g$ is continuous, we know the limit (\ref{eqn:prob7b}) exists and is necessarily equal to $I'(t)=tg(t)$.

Thus $u(t,x)$ is given for any $t \geq 0, x \in \mathbb{R}$ by

\begin{equation} \label{eqn:prob7c} 
u(t,x)=
\begin{cases}
      \frac{1}{2x} \int_{x-t}^{x+t}{sg(s)ds,} & x \neq 0, \\
      tg(t), & x=0 \\
    \end{cases} 
\end{equation}


## Problem 8   
Solve the following characteristic initial value problem:
\begin{equation*} 
\begin{cases}
  y^3u_{xx}-yu_{yy}+u_y=0 & 0<x<4, \quad \lvert y \rvert \leq 2 \sqrt{2} \\
  u(x,y)= f(x) & x+ \frac{y^2}{2}=4 \text{ for } 2 \leq x \leq 4 \\
  u(x,y)=g(x) & x- \frac{y^2}{2}=0 \text{ for } 0 \leq x \leq 2 \\
\end{cases}
\end{equation*}

where $f(2)=g(2)$. Hint: Use the transformation $\eta=x-\frac{y^2}{2}$ and $\xi=x+\frac{y^2}{2}$ and express the PDE in the coordinates $(\xi, \eta)$.


Set $\eta=x-\frac{y^2}{2}$ and $\xi=x+\frac{y^2}{2}$. Then

$$\frac{\partial u}{\partial x} = \frac{\partial u}{\partial \xi} \frac{\partial \xi}{\partial x}+\frac{\partial u}{\partial\eta}\frac{\partial\eta}{\partial x} = \frac{\partial u}{\partial \xi}+\frac{\partial u}{\partial\eta}$$


$$\frac{\partial^2 u}{\partial x^2} = \frac{\partial }{\partial x} \left(\frac{\partial u}{\partial \xi}\right) +\frac{\partial }{\partial x} \left(\frac{\partial u}{\partial \eta}\right)$$


$$=\frac{\partial^2 u}{\partial \xi^2} \frac{\partial \xi}{\partial x}+
\frac{\partial^2 u}{\partial\eta \partial \xi}\frac{\partial \xi}{\partial x} +
\frac{\partial^2 u}{\partial\eta \partial \xi}\frac{\partial\eta}{\partial x}+
\frac{\partial^2 u}{\partial \eta^2}\frac{\partial \eta}{\partial x}  $$

Which we can simplify to

$$u_{xx}= u_{\xi \xi}+2 u_{\xi \eta}+u_{\eta \eta}$$

Now we do the same for $y$:

$$\frac{\partial u}{\partial y} = \frac{\partial u}{\partial \xi} \frac{\partial \xi}{\partial y}+\frac{\partial u}{\partial\eta}\frac{\partial\eta}{\partial y} = y\frac{\partial u}{\partial \xi}-y\frac{\partial u}{\partial\eta}$$

But since $\eta=x-\frac{y^2}{2}$ and $\xi=x+\frac{y^2}{2}$, we can rewrite $y$ as $\sqrt{\xi-\eta}$.

$$\frac{\partial u}{\partial y} = \sqrt{\xi-\eta} \left(\frac{\partial u}{\partial \xi}-\frac{\partial u}{\partial\eta}\right)$$

Now using the product rule,
$$\frac{\partial^2 u}{\partial y^2} = \sqrt{\xi-\eta}\; \frac{\partial}{\partial y}\left(\frac{\partial u}{\partial \xi}-\frac{\partial u}{\partial\eta}\right)+\left(\frac{\partial u}{\partial \xi}-\frac{\partial u}{\partial\eta}\right)$$

Where the second term has been simplified because $\frac{\partial}{\partial y}$ of $\sqrt{\xi-\eta}$ is simply $\frac{\partial}{\partial y}y=1$.

Now we use the chain rule again for the first term:

Now using the product rule,
$$\frac{\partial^2 u}{\partial y^2} = \sqrt{\xi-\eta}\left(\frac{\partial^2 u}{\partial \xi^2} \frac{\partial \xi}{\partial y}+
\frac{\partial^2 u}{\partial\eta \partial \xi}\frac{\partial\eta}{\partial y} -
\frac{\partial^2 u}{\partial \eta^2}\frac{\partial \eta}{\partial y}-
\frac{\partial^2 u}{\partial \eta \partial \xi}\frac{\partial \xi}{\partial y}\right)
+
\left(\frac{\partial u}{\partial \xi}-\frac{\partial u}{\partial\eta}\right)$$

Which simplifies to

$$u_{yy}= \left(\xi-\eta \right)\left(u_{\xi \xi}+u_{\eta \eta} -2 u_{\xi \eta}\right) +u_\xi-u_\eta$$

This means $y^3u_{xx}-yu_{yy}+u_y=0$ becomes

$$\left(\xi-\eta \right)^{\frac{3}{2}} \left(u_{\xi \xi}+2 u_{\xi \eta}+u_{\eta \eta}\right) - \left(\xi-\eta \right)^{\frac{1}{2}} \left[\left(\xi-\eta \right)\left(u_{\xi \xi}-2 u_{\xi \eta}+u_{\eta \eta} \right) +u_\xi-u_\eta \right]+\left(\xi-\eta \right)^{\frac{1}{2}} \left(u_\xi-u_\eta\right)=0  $$

$$\left(\xi-\eta \right)^{\frac{3}{2}} \left(u_{\xi \xi}+2 u_{\xi \eta}+
u_{\eta \eta}\right) - \left(\xi-\eta \right)^{\frac{3}{2}} \left(u_{\xi \xi}-2 u_{\xi \eta}+
u_{\eta \eta}\right)-
\left(\xi-\eta \right)^{\frac{1}{2}} \left(u_\xi-u_\eta\right)+
\left(\xi-\eta \right)^{\frac{1}{2}} \left(u_\xi-u_\eta\right)=0  $$

$$\left(\xi-\eta \right)^{\frac{3}{2}} \left(4\, u_{\xi \eta}\right)=0$$

But by integrating with respect to both variables, we recognize $u_{\xi \eta}=0$ as having the solution

$$u(\xi, \eta)=h_1(\xi)+h_2(\eta),$$

or in our original coordinates,

$$u(x,y)=h_1\left(x+\frac{y^2}{2}\right)+h_2\left(x-\frac{y^2}{2}\right) $$

Now we use our given conditions. When  $2 \leq x \leq 4$, we have $g(x)=h_1(2x)+h_2(0)$, which means $h_1(x)=g\left(\frac{x}{2}\right)-h_2(0)$. 

Similarly, when $0 \leq x \leq 2$, we have $f(x)=h_1(4)+h_2(2x-4)$, which means $h_2(x)=f\left(\frac{x}{2}+2\right)-h_1(4)$.


Thus,
$$h_1(x)+h_2(x)=g\left(\frac{x}{2}\right)-h_2(0)+f\left(\frac{x}{2} + 2\right)-h_1(4)$$

But $h_2(0)+h_1(4)$ is just $g(x)$ when $x=2$ (or equivalently, $f(x)$ when $x=2$), 

so after replacing the $x$ in $h_1(x)$ by $x+\frac{y^2}{2}$ and the $x$ in $h_2(x)$ by $x-\frac{y^2}{2}$, we get

\begin{tcolorbox}[colback=white, title=Solution]
$$u(x,y)=g\left(\frac{x}{2}+\frac{y^2}{4}\right)+f\left(\frac{x}{2}+\frac{y^2}{4}+2\right)-f(2)$$
\end{tcolorbox}

\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=Check solution]
$$u_y(x,y)=\frac{y}{2}g'\left(\frac{x}{2}+\frac{y^2}{4}\right)+\frac{y}{2}f'\left(\frac{x}{2}+\frac{y^2}{4}+2\right)$$

$$u_{yy}(x,y)=\frac{y^2}{4}g''\left(\frac{x}{2}+\frac{y^2}{4}\right)+
\frac{1}{2}g'\left(\frac{x}{2}+\frac{y^2}{4}\right)+
\frac{y^2}{4}f''\left(\frac{x}{2}+\frac{y^2}{4}+2\right)+
\frac{1}{2}f'\left(\frac{x}{2}+\frac{y^2}{4}+2\right)$$

$$u_x(x,y)=\frac{1}{2}g'\left(\frac{x}{2}+\frac{y^2}{4}\right)+\frac{1}{2}f'\left(\frac{x}{2}+\frac{y^2}{4}+2\right)$$


$$u_{xx}(x,y)=\frac{1}{4}g''\left(\frac{x}{2}+\frac{y^2}{4}\right)+\frac{1}{4}f''\left(\frac{x}{2}+\frac{y^2}{4}+2\right)$$


This means $y^3u_{xx}-yu_{yy}+u_y=0$ becomes

\begin{equation*}
  \begin{aligned}
  & \left[\frac{y^3}{4} g''\left(\frac{x}{2} +\frac{y^2}{4}\right) + \frac{y^3}{4} f''\left(\frac{x}{2}+\frac{y^2}{4}+2\right)\right]- \\
  & \left[\frac{y^3}{4}g''\left(\frac{x}{2}+\frac{y^2}{4}\right)+
\frac{y}{2} g' \left(\frac{x}{2}+\frac{y^2}{4} \right)+
\frac{y^3}{4} f'' \left( \frac{x}{2}+ \frac{y^2}{4}+2 \right)+
\frac{y}{2}f' \left( \frac{x}{2}+ \frac{y^2}{4}+2 \right) \right] + \\
  & \left[ \frac{y}{2} g' \left( \frac{x}{2}+ \frac{y^2}{4} \right)+ \frac{y}{2}f' \left( \frac{x}{2}+ \frac{y^2}{4}+2 \right) \right]=0
 \end{aligned}
\end{equation*}

\end{tcolorbox}