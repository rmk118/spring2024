---
title: "BIOL 274 Homework 5"
author: "Ruby Krasnow"
date: "2024-02-28"
output:
  pdf_document:
    extra_dependencies: ["derivative", "tcolorbox", "xcolor"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(expm)
```


Define each of the following scalars, vectors, and matrices:
$$s=3, r=-2, q= \frac{1}{4} $$

\begin{equation*}
    v = \begin{bmatrix} -8 \\ 4 \\ -16 \end{bmatrix},\quad
    w = \begin{bmatrix} 2 \\ -1 \\ 3 \\ 4 \end{bmatrix},\quad
    A = \begin{bmatrix} 
    -1 & 3 & 2 \\ 
    2 & 0 & -1 \\ 
    3 & 5 & -4 \end{bmatrix},
\end{equation*}

\begin{equation*}
    B = \begin{bmatrix} 
    0 & -2 & 7 & 4 \\ 
    6 & 0 & -5 & 1 \\
    0 & 1 & 4 & -2 \end{bmatrix},\quad \text{and} \quad
    C = \begin{bmatrix} 
    11 & -3 & 1 & 0 \\
    -2 & 5 & 0 & -1 \\
    1 & 3 & 0 & 4 \end{bmatrix}
\end{equation*}

We will also define them in R, for use later in checking our manual computations
```{r}
#scalars
s=3
r=-2
q=(1/4)

#vectors
v=c(-8, 4, -16)
w=c(2,-1,3,4)

#matrices
A = matrix(c(-1, 2, 3, 3, 0, 5, 2, -1, -4), nrow=3, ncol=3)
B = matrix(c(0,6,0,-2,0,1,7,-5,4,4,1,-3), nrow=3)
C = matrix(c(11,-2,1,-3,5,3,1,0,0,0,-1,-4), nrow=3)
```

\newcommand{\A}{
    \begin{bmatrix} 
    -1 & 3 & 2 \\ 
    2 & 0 & -1 \\ 
    3 & 5 & -4 \end{bmatrix}}

\newcommand{\negA}{
    \begin{bmatrix} 
    1 & -3 & -2 \\ 
    -2 & 0 & 1 \\ 
    -3 & -5 & 4 \end{bmatrix}}
    
\newcommand{\B}{
    \begin{bmatrix} 
    0 & -2 & 7 & 4 \\ 
    6 & 0 & -5 & 1 \\ 
    0 & 1 & 4 & -3 \end{bmatrix}}
    
\newcommand{\C}{
    \begin{bmatrix} 
    11 & -3 & 1 & 0 \\ 
    -2 & 5 & 0 & -1 \\ 
    1 & 3 & 0 & -4 \end{bmatrix}}
    
\renewcommand{\v}{\begin{bmatrix} -8 \\ 4 \\ -16 \end{bmatrix}}

\newcommand{\w}{\begin{bmatrix} 2 \\ -1 \\ 3 \\ 4 \end{bmatrix}}

Use these to determine each of the following, if possible. If not possible, state why.

## 1. $sw$

\begin{equation*}
    sw = 3\begin{bmatrix} 2 \\ -1 \\ 3 \\ 4 \end{bmatrix} = 
    \begin{bmatrix} 3(2) \\ 3(-1) \\ 3(3) \\ 3(4) \end{bmatrix} =
    \begin{bmatrix} 6 \\ -3 \\ 9 \\ 12 \end{bmatrix}
\end{equation*}

Check our manual computation:
```{r}
as.vector(s*w)
```



## 2. $qv$

\begin{equation*}
    qv = \frac{1}{4} \v =
    \begin{bmatrix} -8/4 \\ 4/4 \\ -16/4 \end{bmatrix} =
     \begin{bmatrix} -2 \\ 1 \\ -4 \end{bmatrix}
\end{equation*}

Check our manual computation:
```{r}
as.vector(q*v)
```




## 3. $v+w$

This is not possible, because $v \in \mathbb{R}^3$ while $w \in \mathbb{R}^4$, and in order to add two vectors, they must be in the same n-dimensional space $\mathbb{R}^n$, where $n$ is the same for both vectors. In other words, $v$ has three elements while $w$ has four. To add vectors, they must be the same size.

When we try to do this in R, we should get an error:
```{r, error=TRUE, results='hide'}
v+w
```




## 4. $(s+r)w$

$$(s+r)w=(3-2)w=w=\w$$

Check our manual computation:
```{r}
as.vector((s+r) %*% w)
```



## 5. $Aw$

This is not possible, because $A$ is a 3 by 3 matrix while $w$ is a vector in $\mathbb{R}^4$. In order for this to be possible, $w$ would need to have three elements, not four.

When we try to do this in R, we should get an error:
```{r, error=TRUE}
A %*% w
```




## 6. $(-A)v$


    
$$ -A = \negA $$
$$ -Av = \negA \v =
\begin{bmatrix}
(1)(-8)+(-3)(4)+(-2)(-16) \\
(-2)(-8)+(0)(4)+(1)(-16) \\
(-3)(-8)+(-5)(4)+(4)(-16)
\end{bmatrix} = \begin{bmatrix} 12 \\ 0 \\ -60 \end{bmatrix} $$

Now we will check our manual computation:
```{r}
negA = -1*A #Define -A

negA %*% v #multiply -A by v
```



## 7. $Bw$
    
$$Bw=\B \w =
\begin{bmatrix}
(0)(2)+(-2)(-1)+(7)(3)+(4)(4) \\
(6)(2)+(0)(-1)+(-5)(3)+(1)(4) \\
(0)(2)+(1)(-1)+(4)(3)+(-3)(4)
\end{bmatrix} = \begin{bmatrix} 39 \\ 1 \\ -1 \end{bmatrix}$$

Now we will check our manual computation:
```{r}
B %*% w #multiply B by w
```

## 8. $B+C$

$$B+C=\B+\C=
\begin{bmatrix}
0+11 & -2-3 & 7+1 & 4+0 \\
6-2 & 0+5 & -5+0 & 1-1 \\
0+1 & 1+3 & 4+0 & -3-4 \end{bmatrix}$$

$$=\begin{bmatrix}
11 & -5 & 8 & 4 \\
4 & 5 & -5 & 0 \\
1 & 4 & 4 & -7 \end{bmatrix}$$

Now we will check our manual computation:
```{r}
B + C #add B and C
```



## 9. $C-B$


$$C-B=\C-\B=
\begin{bmatrix}
11-0 & -3-(-2) & 1-7 & 0-4 \\
-2-6 & 5-0 & 0-(-5) & -1-1 \\
1-0 & 3-1 & 0-4 & -4-(-3) \end{bmatrix}$$

$$=\begin{bmatrix}
11 & -1 & -6 & -4 \\
-8 & 5 & 5 & -2 \\
1 & 2 & -4 & -1 \end{bmatrix}$$

Now we will check our manual computation:
```{r}
C-B #add B and C
```



## 10. $Cv$

This is not possible, because $C$ is a 3 by 4 matrix while $v$ is a vector in $\mathbb{R}^3$. In order for this to be possible, $v$ would need to have four elements, not three.

When we try to do this in R, we should get an error:
```{r, error=TRUE}
C %*% v
```



## 11. $(s-r)B$

$$s-r=3-(-2)=5$$

$$5B= 5\B = \begin{bmatrix}
5(0) & 5(-2) & 5(7) & 5(4) \\
5(6) & 5(0) & 5(-5) & 5(1) \\
5(0) & 5(1) & 5(4) & 5(-3) \end{bmatrix}=
\begin{bmatrix}
0 & -10 & 35 & 20 \\
30 & 0 & -25 & 5 \\
0 & 5 & 20 & -15\end{bmatrix}$$

Now we will check our manual computation:
```{r}
(s-r)*B
```

## 12. $(-sB)v$

This is not possible, because $-sB$ will be a matrix of the same size as $B, \;3 \times 4$, while $v$ is a vector in $\mathbb{R}^3$. In order for this to be possible, $v$ would need to have four elements, not three.


When we try to do this in R, we should get an error:
```{r, error=TRUE}
(-s*B) %*% v
```

R tells us that the error occurs when we try and multiply $B$ with $v$ because it recognizes that $(-sB)v=-s(Bv)$.

## 13. $(qA)v$

We can rewrite this as follows:
$$(qA)v=q(Av)= -q(-Av)=\frac{-1}{4} \left(-Av\right). $$
And since we found $-Av$ in problem 6 above, we can just divide every element in that vector by $-4$ to find our solution:

$$-q \v=
\begin{bmatrix} -12/4 \\ 0 \\ 60/4 \end{bmatrix}=
\begin{bmatrix} -3 \\ 0 \\ 15 \end{bmatrix}$$

Now we will check our manual computation:
```{r}
(q*A) %*% v
```

## 14. $(rC)w$

$$rC=-2 \C=
\begin{bmatrix}
-22 & 6 & -2 & 0 \\
4 & -10 & 0 & 2 \\
-2 & -6 & 0 & 8
\end{bmatrix}$$

Now multiplying this by $w$,

$$\begin{bmatrix}
-22 & 6 & -2 & 0 \\
4 & -10 & 0 & 2 \\
-2 & -6 & 0 & 8
\end{bmatrix} \w =
\begin{bmatrix}
(-22)(2)+(6)(-1)+(-2)(3)+(0)(4) \\
(4)(2)+(-10)(-1)+(0)(3)+(2)(4) \\
(-2)(2)+(-6)(-1)+(0)(3)+(8)(4)
\end{bmatrix} =
\begin{bmatrix} -56 \\ 26 \\ 34 \end{bmatrix}$$

Now we will check our manual computation:
```{r}
(r*C) %*% w
```

## 15. $BA$

This is not possible because $B$ is a $3 \times 4$ matrix, while A is a $3 \times 3$ matrix, and in order to multiply two matrices, the second matrix must have the same number of rows as the first matrix has columns.

When we try to do this in R, we should get an error:
```{r, error=TRUE}
B %*% A
```


## 16. $AB$

This is valid matrix multiplication because $A$ is a $3 \times 3$ matrix and $B$ is a $3 \times 4$ matrix.

$$A B = \A\B$$

$$= \begin{bmatrix}
(-1)(0)+(3)(6)+(2)(0) & (-1)(-2)+(3)(0)+(2)(1) & (-1)(7)+(3)(-5)+(2)(4) & (-1)(4)+(3)(1)+(2)(-3) \\
(2)(0)+(0)(6)+(-1)(0) & (2)(-2)+(0)(0)+(-1)(1) & (2)(7)+(0)(-5)+(-1)(4) & (2)(4)+(0)(1)+(-1)(-3) \\
(3)(0)+(5)(6)+(-4)(0) & (3)(-2)+(5)(0)+(-4)(1) & (3)(7)+(5)(-5)+(-4)(4) & (3)(4)+(5)(1)+(-4)(-3) \end{bmatrix}$$

$$=\begin{bmatrix}
18 & 4 & -14 & -7 \\
0 & -5 & 10 & 11 \\
30 & -10 & -20 & 29
\end{bmatrix} $$

Now we will check our manual computation:
```{r}
A %*% B
```

## 17. $CA$
This is not possible because $C$ is a $3 \times 4$ matrix, while A is a $3 \times 3$ matrix, and in order to multiply two matrices, the second matrix must have the same number of rows as the first matrix has columns.

When we try to do this in R, we should get an error:
```{r, error=TRUE}
C %*% A
```


## 18. $B^2$

This is not possible because $B$ is not a square matrix. Computing $B^2$ is equivalent to $B(B)$, which would be trying to multiply a $3 \times 4$ matrix by another $3 \times 4$ matrix, and in order to multiply two matrices, the second matrix must have the same number of rows as the first matrix has columns.

When we try to do this in R, we should get an error:
```{r, error=TRUE}
B %*% B
```


## 19. $A^2$

$$A^2=AA=\A \A$$
$$=\begin{bmatrix}
(-1)(-1)+(3)(2)+(2)(3) & (-1)(3)+(3)(0)+(2)(5) & (-1)(2)+(3)(-1)+(2)(-4) \\
(2)(-1)+(0)(2)+(-1)(3) & (2)(3)+(0)(0)+(-1)(5) & (2)(2)+(0)(-1)+(-1)(-4) \\
(3)(-1)+(5)(2)+(-4)(3) & (3)(3)+(5)(0)+(-4)(5) & (3)(2)+(5)(-1)+(-4)(-4)
\end{bmatrix}$$

$$=\begin{bmatrix}
13 & 7 & -13 \\
-5 & 1 & 8 \\
-5 & -11 & 17
\end{bmatrix}$$

Now we will check our manual computation:
```{r, message=FALSE}
A %*% A

#or using a function from the package 'expm' 
A %^% 2
```
## 20. $A^3$

Since $A^3$ is equivalent to $A^2 A$, we can simply multiply the matrix we found in the previous part by $A$:

$$A^2 A = \begin{bmatrix}
13 & 7 & -13 \\
-5 & 1 & 8 \\
-5 & -11 & 17
\end{bmatrix} \A$$

$$=\begin{bmatrix}
(13)(-1)+(7)(2)+(-13)(3) & (13)(3)+(7)(0)+(-13)(5) & (13)(2)+(7)(-1)+(-13)(-4) \\
(-5)(-1)+(1)(2)+(8)(3) & (-5)(3)+(1)(0)+(8)(5) & (-5)(2)+(1)(-1)+(8)(-4) \\
(-5)(-1)+(-11)(2)+(17)(3) & (-5)(3)+(-11)(0)+(17)(5) & (-5)(2)+(-11)(-1)+(17)(-4)
\end{bmatrix}$$

$$=\begin{bmatrix}
-38 & -26 & 71 \\
31 & 25 & -43 \\
34 & 70 & -67
\end{bmatrix}$$

Now we will check our manual computation:
```{r}
A %*% A %*% A

#or using a function from the package 'expm' 
A %^% 3
```