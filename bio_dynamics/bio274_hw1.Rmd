---
title: "BIOL 274 Homework 1"
author: "Ruby Krasnow"
date: "2024-01-20"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Question 1
>Assume that once a drug is administered to a patient, it leaves the body following exponential decay. After administration of a dose, the concentration of the drug in the body decreases by 50% in 30 hours. Approximately how long does it take for the drug to decrease to 1% of its initial value (round to the nearest hour)?

We can represent the concentration of drug in the body at time $t$ as $x(t)=x_0e^{kt}$. Since the drug leaves the body according to an exponential decay model, that means $k$ should be negative.

We are given $\frac{x}{x_0}=0.5$ at $t=30$ hours. Plugging into our equation, we get
$$0.5=e^{30k}$$
$$\ln(0.5)=\ln(e^{30k})$$
$$\ln(0.5)=30k$$
$$k=\frac{\ln(0.5)}{30}$$
```{r solve_k_1}
k = log(0.5)/30
k
```

<!-- So $k$ = `r k`. -->
Now, we want to know how long it will take for $x$ to be 1% of $x_0$, or at what time $t$ we will have $\frac{x(t)}{x(0)}=0.01$. 
$$0.01=e^{kt}$$
$$t=\frac{\ln{(0.01)}}{k}$$

```{r solve_t_1}
t = log(0.01)/k
round(t, 0)
```

It will take approximately 199 hours for the drug to decrease to 1% of its initial value.

## Question 2
> Consider the population model: $\frac{dP}{dt}=0.3 \left( 1-\frac{P}{200} \right) \left(\frac{P}{50}-1 \right)P$.  

>a. For what values of P is the population increasing?
b. For what values of P is the population decreasing?

If the population is increasing, that means the rate of change $\frac{dP}{dt}$ is positive, while a decreasing population means that $\frac{dP}{dt}$ is negative. First we need to find the equilibrium points, or the values of $P$ for which $\frac{dP}{dt}=0.3 \left( 1-\frac{P}{200} \right) \left(\frac{P}{50}-1 \right)P=0$.

We can see that this will clearly occur if $P=0$; i.e., the population has no organisms in it. The other equilibrium points occur when
$$1-\frac{P}{200}=0$$
$$1=\frac{P}{200}$$
$$P=200$$

and similarly when $1=\frac{P}{50}$ or $P=50$.
So we need to determine the sign of $\frac{dP}{dt}$ on the intervals $(0,50),(50,200),$ and $(200,\infty)$.
Let's evaluate some convenient values within these intervals: 25, 100, and 400.

```{r}
eqn <- function(P){
  0.3*(1-(P/200))*((P/50-1))*P
} 
eqn(25)
eqn(100)
eqn(400)
```

So the population is decreasing when $0<P<50$ or $P>200$ and the population is increasing when $50<P<200$. Let's confirm this with a quick plot:
```{r}
x=c(1:250)

ggplot()+
  geom_line(aes(x=x, y=0.3*(1-(x/200))*((x/50-1))*x))+
  geom_vline(xintercept = c(50, 200), linetype="dashed")+
  geom_hline(yintercept = 0, linetype="dashed", color="red")+
  theme_bw()+
  labs(x="P", y="dP/dt")
```

We can see that $\frac{dP}{dt}$ is indeed positive and negative over the expected intervals.

## Question 3
Find the general solution to each of the following DEs:

### a)
$$ \frac{dy}{dt}=\frac{3t+1}{2y}$$
$$ 2y \, dy=(3t+1)dt$$
$$\int 2y \, dy=\int(3t+1)dt$$
$$y^2=\frac{3t^2}{2}+t+C$$
$$y=\sqrt{\frac{3t^2}{2}+t+C}$$

### b)
$$\frac{dy}{dx}=x\sqrt[3]{y}$$

$$y^{-\frac{1}{3}} \, dy=x \, dx$$
$$\int y^{-\frac{1}{3}} \, dy= \int x \, dx$$
$$\frac{3}{2}y^{\frac{2}{3}}=\frac{x^2}{2}+C_1$$
$$y^{\frac{2}{3}}=\frac{x^2+C_2}{3}$$
$$y(x)=\left(\frac{x^2+C_2}{3} \right)^\frac{3}{2}=\frac{(x^2+C_2)^{\frac{3}{2}}}{3\sqrt3}$$
Note that $y(x)=0$ is also a solution to the ODE, because $\frac{dy}{dx}$ will equal 0 for all $x$ and $x\sqrt[3]{0}=0$.

### c)
$$\frac{dp}{dt}=\frac{1}{3tp^2}$$
$$3p^2\,dp=\frac{1}{t}dt$$
$$\int 3p^2\,dp=\int \frac{1}{t}dt$$
$$p^3=\ln(t)+C$$
$$p=\sqrt[3]{\ln(t)+C}$$

## Question 4
>According to Newton’s law of cooling, the rate of decrease of temperature of a body is proportional to the difference between its temperature and that of its environment. If the temperature in your living room is 20°C, you remove a log from the fireplace at 100°C, and it takes 10 minutes to cool to 60°C, how long will it take to decrease the temperature of the log to 25°C?

$$\frac{dT}{dt}=k(T_{body}-T_{env})=k(T_{body}-20)$$
$$
\frac{1}{(T_{body}-20)}dT=k\,dt
$$
$$\int\frac{1}{(T_{body}-20)}dT=\int k\,dt$$
$$\ln{(T_{body}-20)}=kt+C_1$$
$$T_{body}=e^{kt+C_1}+20=C_2e^{kt}+20$$
where $C_2=e^{C_1}$.

Since $T_{body}=C_2+20$ at time $t=0$, we can write the equation as
$$T_{body}(t)=(T_0-20)e^{kt}+20$$
for the temperature of the body at time $t$.
Now using the information we are given,
$$60=(100-20)e^{10k}+20$$
$$40=80e^{10k}$$
$$\frac{1}{2}=e^{10k}$$
$$\frac{\ln{(1/2)}}{10}=k$$

```{r solve_k_2}
k2 = log(1/2)/(10)
k2
```

Now we want to solve for $t$ in the following equation:
$$25=(60-20)e^{kt}+20$$
$$5=40e^{kt}$$
$$\frac{\ln{(1/8)}}{k}=t$$

```{r solve_t_2}
t2 = (log(1/8))/(k2)
t2
```

*Quick sanity check*:
If it took 10 minutes to cool from 100°C to 60°C and 30 minutes to cool from 60°C to 25°C, it should take 40 minutes to cool from 100°C to 25°C:
```{r}
# 25=(100-20)e^kt+20
# 5=80e^kt
# ln(1/16)=kt

t3=(log(1/16))/(k2)
t3
```

## Question 5
Solve each of the following IVPs:

### a)
$$\frac{dx}{dt}=-xt,\, x(0)=1/\sqrt{\pi}$$

$$\frac{1}{x}dx=-t\,dt$$
$$\int \frac{1}{x}dx=\int-t\,dt$$
$$\ln{(x)}=-\frac{t^2}{2}+C_1$$

$$x(t)=C_2e^{-t^2/2}$$
is our general solution to the differential equation, where $C_2=e^{C_1}$.
Now we plug in the initial conditions:
$$1/\sqrt{\pi}=C_2e^{-(0^2/2)}=C_2e^0=C_2$$

$$x(t)=\frac{e^{-t^2/2}}{\sqrt{\pi}}$$

is the solution to the IVP.


### b)
$$\frac{dy}{dx}=xy^2+2y^2,\, y(0)=1$$

$$\frac{dy}{dx}=y^2(x+2)$$
$$y^{-2}dy=(x+2)dx$$

$$-\frac{1}{y}=\frac{x^2}{2}+2x+C$$

We can plug in our initial conditions now:
$$-\frac{1}{1}=0+0+C$$
so $C=-1$.
$$-\frac{1}{y}=\frac{x^2}{2}+2x-1$$
$$\frac{1}{y}=1-\frac{x^2}{2}-2x$$
$$\frac{1}{y}=1-\frac{x^2}{2}-2x$$
or
$$\frac{2}{y}=2-x^2-4x$$

$$y(x)=\frac{2}{2-x^2-4x}$$
is the solution to the IVP.

### c)

$$ \frac{du}{dt}=\frac{\cos(t)}{9u^2}, \, u(0)=2$$

$$ u^2du=\frac{\cos(t)}{9}dt$$
$$ \int u^2du=\frac{1}{9}\int \cos(t)dt$$

$$ \frac{u^3}{3}=\frac{1}{9}\sin(t)+C_1$$

$$ u^3=\frac{\sin(t)}{3}+C_2$$

Where $C_2=3C_1$.
Now we plug in the initial conditions:
$$ 2^3=\frac{\sin(0)}{3}+C_2=0+C_2$$
So $C_2=8$ and we have
$$ u(t)=\sqrt[3]{\frac{\sin(t)}{3}+8}$$

as the solution to the IVP.